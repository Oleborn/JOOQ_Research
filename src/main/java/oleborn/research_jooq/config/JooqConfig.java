package oleborn.research_jooq.config;

import org.jooq.conf.RenderNameCase;
import org.springframework.boot.autoconfigure.jooq.DefaultConfigurationCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–û–ù–ù–´–ô –ö–õ–ê–°–° JOOQ - –ù–ê–°–¢–†–û–ô–ö–ê –ü–û–í–ï–î–ï–ù–ò–Ø –ò –†–ï–ù–î–ï–†–ò–ù–ì–ê SQL
 * <p>
 * –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ jOOQ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
 * –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–º —á–µ—Ä–µ–∑ jOOQ DSL.
 */
@Configuration
public class JooqConfig {

    /**
     * –ë–ò–ù –î–õ–Ø –ö–ê–°–¢–û–ú–ò–ó–ê–¶–ò–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò JOOQ
     * <p>
     * DefaultConfigurationCustomizer - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Spring Boot,
     * –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é jOOQ –ø–µ—Ä–µ–¥ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.
     *
     * @return –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ç–æ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
     */
    @Bean
    public DefaultConfigurationCustomizer configurationCustomizer() {
        return config -> {
            // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            config.settings()
                    // üëá –ù–ê–°–¢–†–û–ô–ö–ò –†–ï–ù–î–ï–†–ò–ù–ì–ê –ò–ú–ï–ù (–ö–ê–ö –ò–ú–ï–ù–ê –¢–ê–ë–õ–ò–¶/–ö–û–õ–û–ù–û–ö –í–´–ì–õ–Ø–î–Ø–¢ –í SQL)

                    /* –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–º–µ–Ω –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–º SQL
                     * –ü—Ä–∏–º–µ—Ä:
                     * - –ë—ã–ª–æ: SELECT "USERS"."NAME" FROM "USERS"
                     * - –°—Ç–∞–ª–æ: SELECT users.name FROM users
                     */
                    .withRenderNameCase(RenderNameCase.LOWER)

                    /* –í–∫–ª—é—á–µ–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SQL (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏)
                     * –ü—Ä–∏–º–µ—Ä –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: SELECT name FROM users WHERE id = 1
                     * –ü—Ä–∏–º–µ—Ä —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
                     *   SELECT name
                     *   FROM users
                     *   WHERE id = 1
                     */
                    .withRenderFormatted(true)

            // üëá –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–û–õ–ï–ó–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò:

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–≤—ã—á–µ–∫ –≤–æ–∫—Ä—É–≥ –∏–º–µ–Ω –æ–±—ä–µ–∫—Ç–æ–≤ –ë–î
             * - ALWAYS: –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏ - "table_name"
             * - NEVER: –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏ - table_name
             * - EXPLICIT_DEFAULT_QUOTED: —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
             */
            // .withRenderQuotedNames(RenderQuotedNames.NEVER)

            /* –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (UPPER, LOWER, AS_IS)
             * –ü—Ä–∏–º–µ—Ä:
             * - UPPER: SELECT * FROM USERS
             * - LOWER: select * from users
             */
            // .withRenderKeywordCase(RenderNameCase.UPPER)

            /* –í–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
             * - true: SELECT * FROM users WHERE id = ? (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
             * - false: SELECT * FROM users WHERE id = 1
             */
            // .withRenderScalarSubqueriesForStoredFunctions(true)

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å—Ö–µ–º—ã –≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º SQL
             * - ALWAYS: –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å –∏–º—è —Å—Ö–µ–º—ã - schema.table
             * - NEVER: –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∫–ª—é—á–∞—Ç—å - table
             * - QUALIFIED: –≤–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
             */
            // .withRenderSchema(false)

            /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ –æ–¥–Ω–æ–º INSERT –∑–∞–ø—Ä–æ—Å–µ
             * –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –±–∞—Ç—á-–≤—Å—Ç–∞–≤–æ–∫, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
             */
            // .withInsertBatchSize(1000)

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ SQL
             * - INLINE: –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ç–∏–ø—ã –≤ –∑–∞–ø—Ä–æ—Å - CAST(? AS VARCHAR)
             * - BIND: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bind variables
             */
            // .withParamType(ParamType.INDEXED)

            /* –í–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–∏–∞–ª–µ–∫—Ç–µ SQL –≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
             * –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
             */
            // .withRenderCatalog(true)

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è NULL –≤ ORDER BY
             * - NULLS FIRST: NULL –∑–Ω–∞—á–µ–Ω–∏—è –∏–¥—É—Ç –ø–µ—Ä–≤—ã–º–∏
             * - NULLS LAST: NULL –∑–Ω–∞—á–µ–Ω–∏—è –∏–¥—É—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏
             * - DEFAULT: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
             */
            // .withRenderOrderByNullsFirst(true)
            ;

            // üëá –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò (–ù–ï –¢–û–õ–¨–ö–û SETTINGS):

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π)
             * –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
             */
            // config.set(new DefaultExecuteListenerProvider(new MyCustomExecuteListener()));

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏–∞–ª–µ–∫—Ç–∞ –ë–î (–æ–±—ã—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ DataSource)
             * –ù–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —è–≤–Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å
             */
            // config.set(SQLDialect.POSTGRES);

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
             * (–æ–±—ã—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Spring Boot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ DataSource)
             */
            // config.setConnectionProvider(...);

            /* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
             * (–æ–±—ã—á–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ Spring Transaction Management)
             */
            // config.setTransactionProvider(new SpringTransactionProvider(...));
        };
    }
}